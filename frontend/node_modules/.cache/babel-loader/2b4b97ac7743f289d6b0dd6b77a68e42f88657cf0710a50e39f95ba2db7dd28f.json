{"ast":null,"code":"import React from'react';import{Button}from'@mui/material';import*as XLSX from'xlsx';import{jsx as _jsx}from\"react/jsx-runtime\";const DownloadButton=_ref=>{let{results}=_ref;const handleDownload=()=>{var _results$violations;if(!results){console.error('Results object is undefined');return;}// Prepare data for Excel\nconst data=[{Header:'Violations',Value:((_results$violations=results.violations)===null||_results$violations===void 0?void 0:_results$violations.join(', '))||'None'},{Header:'Final Trench Width',Value:results.finalTrenchWidth||'N/A'},{Header:'Final Trench Depth',Value:results.finalTrenchDepth||'N/A'}];// Convert data to worksheet\nconst worksheet=XLSX.utils.json_to_sheet(data,{header:['Header','Value']});const workbook=XLSX.utils.book_new();XLSX.utils.book_append_sheet(workbook,worksheet,'Trench Results');// Create Excel file and trigger download\nconst excelBuffer=XLSX.write(workbook,{bookType:'xlsx',type:'array'});const blob=new Blob([excelBuffer],{type:'application/octet-stream'});const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.setAttribute('download','trench_results.xlsx');document.body.appendChild(link);link.click();document.body.removeChild(link);};return/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",style:{marginTop:'10px'},onClick:handleDownload,children:\"Download Excel Sheet\"});};export default DownloadButton;","map":{"version":3,"names":["React","Button","XLSX","jsx","_jsx","DownloadButton","_ref","results","handleDownload","_results$violations","console","error","data","Header","Value","violations","join","finalTrenchWidth","finalTrenchDepth","worksheet","utils","json_to_sheet","header","workbook","book_new","book_append_sheet","excelBuffer","write","bookType","type","blob","Blob","url","window","URL","createObjectURL","link","document","createElement","href","setAttribute","body","appendChild","click","removeChild","variant","color","style","marginTop","onClick","children"],"sources":["/Users/masood/default-workspace/trench-calculation-microservice/frontend/src/components/DownloadButton.js"],"sourcesContent":["import React from 'react';\nimport { Button } from '@mui/material';\nimport * as XLSX from 'xlsx';\n\nconst DownloadButton = ({ results }) => {\n  const handleDownload = () => {\n    if (!results) {\n      console.error('Results object is undefined');\n      return;\n    }\n\n    // Prepare data for Excel\n\tconst data = [\n\t  { Header: 'Violations', Value: results.violations?.join(', ') || 'None' },\n\t  { Header: 'Final Trench Width', Value: results.finalTrenchWidth || 'N/A' },\n\t  { Header: 'Final Trench Depth', Value: results.finalTrenchDepth || 'N/A' },\n\t];\n\n\n    // Convert data to worksheet\n    const worksheet = XLSX.utils.json_to_sheet(data, { header: ['Header', 'Value'] });\n    const workbook = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Trench Results');\n\n    // Create Excel file and trigger download\n    const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\n    const blob = new Blob([excelBuffer], { type: 'application/octet-stream' });\n    const url = window.URL.createObjectURL(blob);\n\n    const link = document.createElement('a');\n    link.href = url;\n    link.setAttribute('download', 'trench_results.xlsx');\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  };\n\n  return (\n    <Button\n      variant=\"contained\"\n      color=\"primary\"\n      style={{ marginTop: '10px' }}\n      onClick={handleDownload}\n    >\n      Download Excel Sheet\n    </Button>\n  );\n};\n\nexport default DownloadButton;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,MAAM,KAAQ,eAAe,CACtC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE7B,KAAM,CAAAC,cAAc,CAAGC,IAAA,EAAiB,IAAhB,CAAEC,OAAQ,CAAC,CAAAD,IAAA,CACjC,KAAM,CAAAE,cAAc,CAAGA,CAAA,GAAM,KAAAC,mBAAA,CAC3B,GAAI,CAACF,OAAO,CAAE,CACZG,OAAO,CAACC,KAAK,CAAC,6BAA6B,CAAC,CAC5C,OACF,CAEA;AACH,KAAM,CAAAC,IAAI,CAAG,CACX,CAAEC,MAAM,CAAE,YAAY,CAAEC,KAAK,CAAE,EAAAL,mBAAA,CAAAF,OAAO,CAACQ,UAAU,UAAAN,mBAAA,iBAAlBA,mBAAA,CAAoBO,IAAI,CAAC,IAAI,CAAC,GAAI,MAAO,CAAC,CACzE,CAAEH,MAAM,CAAE,oBAAoB,CAAEC,KAAK,CAAEP,OAAO,CAACU,gBAAgB,EAAI,KAAM,CAAC,CAC1E,CAAEJ,MAAM,CAAE,oBAAoB,CAAEC,KAAK,CAAEP,OAAO,CAACW,gBAAgB,EAAI,KAAM,CAAC,CAC3E,CAGE;AACA,KAAM,CAAAC,SAAS,CAAGjB,IAAI,CAACkB,KAAK,CAACC,aAAa,CAACT,IAAI,CAAE,CAAEU,MAAM,CAAE,CAAC,QAAQ,CAAE,OAAO,CAAE,CAAC,CAAC,CACjF,KAAM,CAAAC,QAAQ,CAAGrB,IAAI,CAACkB,KAAK,CAACI,QAAQ,CAAC,CAAC,CACtCtB,IAAI,CAACkB,KAAK,CAACK,iBAAiB,CAACF,QAAQ,CAAEJ,SAAS,CAAE,gBAAgB,CAAC,CAEnE;AACA,KAAM,CAAAO,WAAW,CAAGxB,IAAI,CAACyB,KAAK,CAACJ,QAAQ,CAAE,CAAEK,QAAQ,CAAE,MAAM,CAAEC,IAAI,CAAE,OAAQ,CAAC,CAAC,CAC7E,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAAC,CAACL,WAAW,CAAC,CAAE,CAAEG,IAAI,CAAE,0BAA2B,CAAC,CAAC,CAC1E,KAAM,CAAAG,GAAG,CAAGC,MAAM,CAACC,GAAG,CAACC,eAAe,CAACL,IAAI,CAAC,CAE5C,KAAM,CAAAM,IAAI,CAAGC,QAAQ,CAACC,aAAa,CAAC,GAAG,CAAC,CACxCF,IAAI,CAACG,IAAI,CAAGP,GAAG,CACfI,IAAI,CAACI,YAAY,CAAC,UAAU,CAAE,qBAAqB,CAAC,CACpDH,QAAQ,CAACI,IAAI,CAACC,WAAW,CAACN,IAAI,CAAC,CAC/BA,IAAI,CAACO,KAAK,CAAC,CAAC,CACZN,QAAQ,CAACI,IAAI,CAACG,WAAW,CAACR,IAAI,CAAC,CACjC,CAAC,CAED,mBACEhC,IAAA,CAACH,MAAM,EACL4C,OAAO,CAAC,WAAW,CACnBC,KAAK,CAAC,SAAS,CACfC,KAAK,CAAE,CAAEC,SAAS,CAAE,MAAO,CAAE,CAC7BC,OAAO,CAAEzC,cAAe,CAAA0C,QAAA,CACzB,sBAED,CAAQ,CAAC,CAEb,CAAC,CAED,cAAe,CAAA7C,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}